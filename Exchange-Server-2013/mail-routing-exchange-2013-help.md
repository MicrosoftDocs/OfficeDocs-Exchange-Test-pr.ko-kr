---
title: '메일 라우팅: Exchange 2013 Help'
TOCTitle: 메일 라우팅
ms:assetid: 6fd39079-9655-4fd9-9269-c7462c76e0a7
ms:mtpsurl: https://technet.microsoft.com/ko-kr/library/Aa998825(v=EXCHG.150)
ms:contentKeyID: 50483340
ms.date: 05/22/2018
mtps_version: v=EXCHG.150
ms.translationtype: MT
---

# 메일 라우팅

 

_**적용 대상:**Exchange Server 2013_

_**마지막으로 수정된 항목:**2015-03-09_

Microsoft Exchange Server 2013 조직에서 사서함 서버에 있는 Transport Service의 기본 작업은 사용자 및 외부 원본으로부터 받은 메시지를 최종 대상으로 라우팅하는 것입니다. 라우팅 결정은 메시지를 분류하는 동안 이루어집니다. 분류기는 들어오는 메시지를 모두 처리하고 대상에 대한 정보에 따라 메시지로 수행할 작업을 결정하는 사서함 서버의 Transport Service 구성 요소입니다.

이제 Exchange 2013에 라우팅할 경우 DAG(데이터베이스 가용성 그룹)가 완벽하게 인식되고 DAG 구성원이 라우팅 경계로 사용됩니다. 그 이유는 Exchange 2013에서 모든 사서함 서버가 Transport Service를 호스트하기 때문입니다. 따라서 사서함 서버가 DAG에 속해 있는 경우 메시지를 라우팅하기 위한 기본 메커니즘이 DAG에 맞추어져 있습니다. DAG가 여러 Active Directory 사이트에 걸쳐 있는 경우 Active Directory 사이트만을 기본 라우팅 경계로 사용하는 것은 충분하지 않습니다. Exchange 2013에서는 이전 버전의 Exchange와 라우팅 상호 작용을 위해 DAG에 속해 있지 않은 사서함 서버에 대한 라우팅 경계로 Active Directory 사이트 구성원도 사용합니다. Exchange 2013에 대한 기타 주목할 만한 변경 사항에는 다음이 포함됩니다.

  - 사서함 서버의 Transport Service는 사서함 데이터베이스와 직접 통신하지 않습니다. 대신 Transport Service는 사서함 서버의 사서함 Transport Service와 통신합니다. Mailbox Transport Service만 로컬 사서함 서버의 사서함 데이터베이스와 통신합니다. 사서함 서버가 DAG의 구성원인 경우 사서함 데이터베이스의 활성 복사본이 보관되는 사서함 서버의 Mailbox Transport Service에서만 대상 받는 사람에 대한 메시지를 수락합니다.

  - RPC(원격 프로시저 호출)는 Mailbox Transport Service가 로컬 사서함 데이터베이스와 메시지를 주고 받는 경우에만 사용됩니다. 사서함 서버가 DAG의 구성원인 경우 Mailbox Transport Service에서는 사서함 데이터베이스의 활성 복사본과 로컬로 통신하는 데 RPC만 사용합니다. 즉, RPC는 서버 간 통신에 사용되지 않습니다. 대신 다른 사서함 서버의 Mailbox Transport Service와 Transport Service는 항상 SMTP를 사용하여 통신합니다.

  - Exchange 2013에서는 원격 대상에 대해 더욱 정확한 큐를 사용합니다. 원격 Active Directory 사이트의 모든 대상에 대해 하나의 큐를 사용하는 대신 Exchange 2013에서는 개별 송신 커넥터와 같은 Active Directory 사이트 내의 특정 대상에 대한 메시지를 큐에 넣습니다.

  - 연결된 커넥터는 사용되지 않습니다. 연결된 커넥터는 송신 커넥터에 연결된 수신 커넥터입니다. 수신 커넥터에서 받은 모든 메시지는 자동으로 송신 커넥터에 전달됩니다.

**목차**

Routing components

  - Routing destinations

  - Delivery groups

  - Queues

Routing messages

  - Routing messages between Active Directory sites

  - Routing in the Front End Transport service

  - Routing in the Mailbox Transport service

  - Routing in the Transport service on Edge Transport servers

## 라우팅 구성 요소

Exchange 2013 사서함 서버의 Transport Service가 메시지를 받을 때 해당 메시지가 분류되어야 합니다. 메시지 분류의 첫 단계는 받는 사람 확인입니다. 받는 사람을 확인하고 나면 최종 대상을 결정할 수 있습니다. 다음 단계인 라우팅에서는 가장 효율적으로 해당 대상에 도달하는 방법을 결정합니다. Exchange 2013에서의 라우팅은 일반적으로 라우팅 대상 및 배달 그룹이라는 개념을 도입하여 유연성이 향상되고 복잡성이 줄어들었습니다.

## 라우팅 대상

Exchange 2013에서는 메시지의 최종 대상을 *라우팅 대상*이라고 합니다. Exchange 2013에는 다음과 같은 라우팅 대상이 있습니다.

  - **사서함 데이터베이스**   Exchange 조직에서 사서함 서버의 사서함이 있는 받는 사람에 대한 라우팅 대상입니다. Exchange 2013에서 공용 폴더는 사서함의 한 유형으로, 공용 폴더 받는 사람에 대한 메시지 라우팅은 사서함 받는 사람에 대한 메시지 라우팅과 동일합니다.

  - **커넥터**   커넥터는 라우팅 대상으로 사용될 때 SMTP 메시지의 송신 커넥터입니다. 비 SMTP 메시지에 대한 라우팅 대상으로는 배달 에이전트 커넥터나 외부 커넥터가 사용됩니다.

  - **메일 그룹 확장 서버**   메일 그룹이 그룹의 구성원 목록을 확장하는 확장 서버로 지정된 경우의 라우팅 대상입니다. 메일 그룹 확장 서버는 항상 허브 전송 서버나 Exchange 2013 사서함 서버입니다.

이전 버전의 Exchange에도 이와 동일한 라우팅 대상이 있습니다.

맨 위로 이동

## 배달 그룹

Exchange 2013의 각 라우팅 대상에는 메시지를 해당 라우팅 대상에 배달하는 하나 이상의 전송 서버 모음이 있습니다. 이 전송 서버의 모음을 *배달 그룹*이라고 합니다. 전송 서버는 Exchange 2013 사서함 서버이거나 허브 전송 서버 역할이 설치된 Exchange 2010 서버 또는 Exchange 2007 서버일 수 있습니다. 라우팅 대상이 사서함 데이터베이스인 경우 배달 그룹의 전송 서버는 사서함 데이터베이스와 동일한 버전의 Exchange입니다. 라우팅 대상이 커넥터 또는 메일 그룹 확장 서버인 경우 배달 그룹에 Exchange 2013 사서함 서버와 Exchange 2010 또는 Exchange 2007 허브 전송 서버가 함께 포함될 수도 있습니다. 메시지가 라우팅되는 방법은 원본 전송 서버와 대상 배달 그룹 간의 관계에 따라 달라집니다.

  - 원본 전송 서버가 대상 배달 그룹에 있는 경우 라우팅 대상 자체는 메시지의 다음 홉입니다. 메시지는 원본 전송 서버에 의해 배달 그룹의 전송 서버에 있는 사서함 데이터베이스나 커넥터에 배달됩니다. 메일 그룹 확장 서버가 라우팅 대상이면 메일 그룹은 메시지가 메일 그룹 확장 서버에서 분류를 위한 라우팅 단계에 도달할 때 이미 확장됩니다. 따라서 메일 그룹 확장 서버의 라우팅 대상은 항상 사서함 데이터베이스나 커넥터입니다.

  - 원본 전송 서버가 대상 배달 그룹 외부에 있는 경우 메시지는 최소 비용 라우팅 경로를 통해 대상 배달 그룹에 릴레이됩니다. Exchange 토폴로지의 크기 및 복잡성에 따라 메시지는 최소 비용 라우팅 경로를 통해 다른 전송 서버에 릴레이되거나 대상 배달 그룹의 전송 서버에 직접 릴레이됩니다.

Exchange 2013에는 다음과 같은 유형의 배달 그룹이 있습니다.

  - **라우팅할 수 있는 DAG**   하나의 DAG에 속해 있는 Exchange 2013 사서함 서버의 모음입니다. DAG의 사서함 데이터베이스는 이 배달 그룹에서 제공하는 라우팅 대상입니다. 메시지가 DAG에 속해 있는 사서함 서버의 Transport Service에 도착하면 Transport Service에서는 대상 사서함 데이터베이스의 활성 복사본이 현재 보관되어 있는 DAG의 사서함 서버에 있는 Mailbox Transport Service로 해당 메시지를 라우팅합니다. 그런 다음 대상 사서함 서버의 Mailbox Transport Service에서 메시지를 로컬 사서함 데이터베이스에 배달합니다. DAG에 다른 Active Directory 사이트에 있는 사서함 서버가 포함될 수도 있지만 DAG가 배달 그룹 경계입니다.

  - **사서함 배달 그룹**   하나의 Active Directory 사이트에 있는 동일한 버전의 Exchange 서버 모음입니다. Active Directory 사이트는 배달 그룹 경계입니다. 사서함 배달 그룹을 제공하는 라우팅 대상 및 배달 그룹은 Active Directory 사이트에 있는 주요 릴리스 버전의 Exchange로 구분됩니다. Exchange 2010 사서함 서버에 있는 사서함 데이터베이스는 Active Directory 사이트에 있는 Exchange 2010 허브 전송 서버에서 제공합니다. Exchange 2007 사서함 서버에 있는 사서함 데이터베이스는 Active Directory 사이트에 있는 Exchange 2007 허브 전송 서버에서 제공합니다. DAG에 속하지 않는 Active Directory 사이트의 Exchange 2013 사서함 서버에 있는 사서함 데이터베이스는 Active Directory 사이트의 Exchange 2013 사서함 서버에 있는 Transport Service에서 제공합니다. 메시지가 사서함 데이터베이스에 배달되는 방법은 다음과 같이 Exchange의 버전에 따라 달라집니다.
    
      - **Exchange 2013**    메시지가 대상 Active Directory 사이트의 대상 사서함 서버에 도착하면 Transport Service에서는 SMTP를 사용하여 해당 메시지를 Mailbox Transport Service로 전송합니다. 그런 다음 Mailbox Transport Service에서 RPC를 사용하여 메시지를 로컬 사서함 데이터베이스에 배달합니다.
    
      - **Exchange 2010 또는 Exchange 2007**   메시지가 대상 Active Directory 사이트의 같은 버전의 임의 허브 전송 서버에 도착하면 허브 전송 서버의 저장소 드라이버에서는 RPC를 사용하여 사서함 데이터베이스에 메시지를 씁니다.

  - **커넥터 원본 서버**   송신 커넥터, 배달 에이전트 커넥터 또는 외부 커넥터에 대한 원본 서버로 범위가 지정된 Exchange 2010 또는 Exchange 2007 허브 전송 서버 또는 Exchange 2013 사서함 서버의 혼합 모음입니다. 커넥터가 이 라우팅 그룹에서 제공하는 라우팅 대상입니다. 커넥터의 범위가 특정 서버로 지정된 경우 해당 서버에서만 커넥터에 의해 정의된 대상으로 메시지를 라우팅할 수 있습니다. 이 배달 그룹에는 다른 Active Directory 사이트에 있는 Exchange 2010 또는 Exchange 2007 허브 전송 서버나 Exchange 2013 사서함 서버가 포함될 수 있습니다.

  - **AD 사이트**   경우에 따라 Active Directory 사이트가 메시지의 최종 대상이 아닐 수 있지만 메시지는 Active Directory 사이트의 Exchange 2010 또는 Exchange 2007 허브 전송 서버나 Exchange 2013 사서함 서버를 통해 전달되어야 합니다. 예를 들면 다음과 같습니다.
    
      - Active Directory 사이트가 허브 사이트로 구성되어 있는 경우. 허브 사이트가 메시지 배달을 위한 최소 비용 라우팅 경로에 있을 때는 메시지는 최종 대상으로 릴레이되기 전에 허브 사이트의 전송 서버에 의해 큐에 넣어지고 처리됩니다.
    
      - Edge 전송 서버가 Active Directory 사이트에 구독된 경우. 이러한 가입된 Edge 전송 서버는 다른 Active Directory 사이트에서 직접 액세스할 수 없습니다. Edge 전송 서버에서는 Exchange 2013, Exchange 2010 또는 Exchange 2007을 실행할 수 있습니다.
    

    > [!NOTE]
    > 배달 그룹이 Active Directory 사이트인 경우에만 지연된 팬아웃이 사용됩니다. 여러 받는 사람이 최소 비용 라우팅 경로의 일부를 공유하는 경우 지연된 팬아웃을 통해 메시지 전송 수가 줄어듭니다.



  - **서버 목록**   대상 그룹 확장 서버로 구성된 하나 이상의 Exchange 2010 또는 Exchange 2007 허브 전송 서버 또는 Exchange 2013 사서함 서버의 모음입니다. 대상 그룹 확장 서버가 이 배달 그룹에서 제공하는 라우팅 대상입니다.

배달 그룹 구성원은 상호 배타적이지 않습니다. 예를 들어 DAG의 구성원인 Exchange 2013 사서함 서버는 범위가 지정된 송신 커넥터의 원본 서버일 수도 있습니다. 이 사서함 서버는 DAG의 사서함 데이터베이스에 대한 라우팅할 수 있는 DAG 배달 그룹에 속해 있으며 범위가 지정된 송신 커넥터의 커넥터 원본 서버 배달 그룹에도 속해 있습니다.

다음 표에서는 관련된 Exchange 버전을 기반으로 라우팅 대상을 배달 그룹에 매핑합니다.


<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th> </th>
<th>Exchange 2013 사서함 서버</th>
<th>Exchange 2010 또는 Exchange 2007 허브 전송 서버</th>
<th>경계 네트워크의 Edge 전송 서버</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>DAG의 사서함 데이터베이스</p></td>
<td><p>라우팅할 수 있는 DAG</p></td>
<td><p>사서함 배달 그룹</p></td>
<td><p>해당 없음</p></td>
</tr>
<tr class="even">
<td><p>DAG에 없는 사서함 데이터베이스</p></td>
<td><p>사서함 배달 그룹</p></td>
<td><p>사서함 배달 그룹</p></td>
<td><p>해당 없음</p></td>
</tr>
<tr class="odd">
<td><p>커넥터</p></td>
<td><p>커넥터의 원본 서버</p></td>
<td><p>커넥터의 원본 서버</p></td>
<td><p>AD 사이트</p></td>
</tr>
<tr class="even">
<td><p>메일 그룹 확장 서버</p></td>
<td><p>서버 목록</p></td>
<td><p>서버 목록</p></td>
<td><p>해당 없음</p></td>
</tr>
</tbody>
</table>


맨 위로 이동

## 큐

보내는 서버의 측면에서 볼 때 각 배달 큐는 특정 메시지의 대상을 나타냅니다. Exchange 2013 사서함 서버의 Transport Service에서 메시지의 대상을 선택하면 해당 대상은 받는 사람에 대해 **NextHopSolutionKey** 특성으로 스탬프 처리됩니다. 하나의 메시지를 여러 받는 사람에게 보내는 경우 각 받는 사람에게 **NextHopSolutionKey** 특성이 적용됩니다. 받는 서버에서도 메시지 분류를 수행하고 메시지를 배달용으로 대기시킵니다. 메시지가 대기 상태가 되고 나면 특정 큐의 배달 유형을 확인하여 해당 메시지가 다음 홉 대상에 도달했을 때 다시 릴레이할 것인지를 결정할 수 있습니다. **NextHopSolutionKey** 특성의 모든 고유한 값은 개별 배달 큐에 해당합니다.

자세한 내용은 [큐](queues-exchange-2013-help.md) 항목의 "NextHopSolutionKey" 섹션을 참조하십시오.

맨 위로 이동

## 메시지 라우팅

메시지를 원격 배달 그룹에 배달해야 하는 경우 메시지의 라우팅 경로를 결정해야 합니다. Exchange 2013에서는 다음과 같은 논리를 사용하여 메시지의 라우팅 경로를 선택합니다. 이 논리는 기본적으로 Exchange 2010에서도 변경되지 않습니다.

1.  대상에 도달하기 위해 통과해야 하는 IP 사이트 링크의 비용을 합하여 최소 비용의 라우팅 경로를 계산합니다. 대상이 커넥터인 경우 주소 공간에 할당된 순위가 선택한 커넥터에 도달하기 위한 순위에 더해집니다. 사용 가능한 라우팅 경로가 여러 개인 경우 집계 비용이 가장 낮은 라우팅 경로가 사용됩니다.

2.  집계 순위가 같은 여러 라우팅 경로가 있는 경우에는 각 경로의 홉 수를 평가하여 홉 수가 가장 적은 라우팅 경로가 사용됩니다.

3.  여러 개의 라우팅 경로를 사용할 수 있는 경우에는 대상 앞의 Active Directory 사이트에 지정된 이름이 고려됩니다. 그런 다음 대상에 가장 가까운 Active Directory 사이트가 영숫자순으로 가장 낮은 순위인 라우팅 경로가 사용됩니다. 대상에 가장 가까운 사이트가 평가 중인 모든 라우팅 경로에서 동일한 경우에는 이전 사이트 이름을 검토합니다.

Exchange 2010에서는 각 메시지 받는 사람이 항상 하나의 Active Directory 사이트에만 연결되며 원본 Active Directory 사이트에서 대상 Active Directory 사이트에 이르기까지 하나의 최소 비용 라우팅만 있습니다. Exchange 2013에서는 배달 그룹이 여러 Active Directory 사이트에 걸쳐 있을 수 있으며 이러한 여러 Active Directory 사이트에 대해 여러 개의 최소 비용 라우팅 경로가 있습니다. Exchange 2013에서는 대상 배달 그룹의 단일 Active Directory 사이트가 *기본 사이트*로 지정됩니다. 기본 사이트는 윗부분에서 설명한 라우팅 논리를 기반으로 가장 가까운 Active Directory 사이트입니다. 배달 그룹 간의 메시지를 라우팅하기 위해 Exchange 2013에서는 다음과 같은 문제를 고려합니다.

  - **최소 비용 라우팅 경로에 하나 이상의 허브 사이트가 있는지 여부**   기본 사이트에 대한 최소 비용 라우팅 경로에 허브 사이트가 포함되어 있는 경우에는 허브 사이트를 통해 메시지를 라우팅해야 합니다. 최소 비용 라우팅 경로를 통해 가장 가까운 허브 사이트가 허브 사이트에 모든 전송 서버가 포함되는 **AD site** 유형의 새 배달 그룹으로 선택됩니다. 메시지가 허브 사이트를 통과한 후 해당 메시지는 최소 비용 라우팅 경로를 통해 계속 라우팅됩니다. 기본 사이트가 허브 사이트가 될 경우 기본 사이트는 다음과 같은 이유로 계속 허브 사이트로 간주됩니다.
    
      - 대상 배달 서버가 여러 Active Directory 사이트에 걸쳐 있는 경우 원본 서버에서는 허브 사이트의 서버에 대한 연결만 시도해야 합니다.
    
      - 실제로 대상 배달 그룹에 속해 있는 허브 사이트의 서비스가 선호됩니다.
    
    이전 버전의 Exchange와 마찬가지로 기본 사이트에 대한 최소 비용 라우팅 경로에 없는 허브 사이트는 무시됩니다.

  - **대상 라우팅 그룹에서 대상 Exchange 서버를 선택할지 여부**   대상 배달 그룹이 여러 Active Directory 사이트에 걸쳐 있는 경우 배달 그룹 내의 특정 서버에 대한 라우팅 경로 비용이 다를 수 있습니다. 가장 가까운 Active Directory 사이트에 있는 서버가 최저 비용 라우팅 경로를 기반으로 배달 그룹의 대상 서버로 선택되고 이러한 서버가 있는 Active Directory 사이트가 기본 사이트로 선택됩니다.

  - **대상 라우팅 그룹의 모든 서버에 대한 연결이 실패할 경우 대체 옵션**   대상 배달 그룹이 여러 Active Directory 사이트에 걸쳐 있는 경우 첫 번째 대체 옵션은 대상 서버로 선택되지 않은 다른 Active Directory 사이트의 대상 배달 그룹에 있는 다른 모든 서버를 사용하는 것입니다. 서버는 다른 Active Directory 사이트에 대한 라우팅 경로의 비용을 기반으로 선택합니다. 대상 배달 그룹에 로컬 Active Directory 사이트의 서버가 있으면 가능한 한 대상 라우팅 대상에 가까이 메시지가 이미 있으므로 다른 대체 옵션이 없습니다. 대상 배달 그룹에 원격 Active Directory 사이트의 서버가 있으면 대체 옵션은 기본 사이트의 다른 모든 서버에 연결을 시도하는 것입니다. 실패한 경우 기본 사이트에 대한 최소 비용 라우팅 경로의 백오프 경로가 사용됩니다. Exchange 2013에서는 연결될 때까지 최소 비용 라우팅 경로를 따라 홉 바이 홉으로 백오프를 수행하여 가능한 한 대상에 가까이 메시지가 전달됩니다.

맨 위로 이동

## Active Directory 사이트 간의 메시지 라우팅

Exchange 2013에서 Active Directory 사이트 간에 메시지를 라우팅하는 방법은 Exchange 2010과 거의 동일합니다. 자세한 내용은 [Active Directory 사이트간 메일 라우팅](route-mail-between-active-directory-sites-exchange-2013-help.md)를 참조하세요.

맨 위로 이동

## 클라이언트 액세스 서버에 있는 프런트 엔드 전송 서비스의 라우팅

이 서비스는 Exchange 2013 조직의 모든 인바운드 및 아웃바운드(선택 사항) 외부 SMTP 트래픽에 대한 상태 비저장 프록시로 작동됩니다. 보내는 메시지의 경우 Transport Service에서는 송신 커넥터를 사용하여 클라이언트 액세스 서버의 Front End Transport Service와 통신합니다. 특히 보내는 메시지는 적용 가능한 송신 커넥터의 *FrontEndProxyEnabled* 매개 변수가 `$true`로 설정되어 있거나 EAC(Exchange 관리 센터)의 송신 커넥터 속성에서 **클라이언트 액세스 서버를 통해 프록시** 옵션이 선택되어 있으면 Front End Transport Service를 통해 프록시됩니다. 로컬 Active Directory 사이트의 모든 클라이언트 액세스 서버가 선택됩니다. 프런트 엔드 전송 서비스에는 송신 커넥터가 없습니다.

들어오는 메시지의 경우 Front End Transport Service는 받는 사람의 수나 유형에 관계없이 사서함 서버에서 정상 상태의 단일 Transport Service를 빠르게 찾아 메시지 전송을 받아야 합니다. 메시지 전송을 받지 못하면 인식되는 전자 메일 서비스를 외부의 보낸 사람이 사용할 수 없게 됩니다. Transport Service와 마찬가지로 Front End Transport Service에서는 Active Directory의 정보를 기반으로 라우팅 테이블을 로드하고 배달 그룹을 사용하여 메시지를 라우팅하는 방법을 결정합니다. 그러나 Front End Transport Service에서 사용되는 라우팅 테이블에는 다음과 같은 고유 특성이 있습니다.

  - 사서함 서버 및 클라이언트 액세스 서버가 동일한 실제 서버에 설치되어 있는 경우에도 Front End Transport Service는 배달 그룹의 구성원으로 간주되지 않습니다. 이렇게 하면 Front End Transport Service가 Transport Service와만 통신합니다.

  - 라우팅 테이블에는 송신 커넥터 경로가 포함되어 있지 않습니다.

  - 라우팅 테이블에는 빠른 장애 조치(failover)를 위한 로컬 Active Directory 사이트에 있는 특별한 사서함 서버 목록이 들어 있습니다.

Front End Transport Service에서 라우팅하면 메시지 받는 사람이 사서함 데이터베이스로 확인됩니다. Front End Transport Service에서 사용되는 사서함 서버의 목록은 메시지 받는 사람의 사서함 데이터베이스를 기반으로 합니다. 예를 들어 받는 사람이 메일 그룹이거나 메일 사용자인 경우 사서함을 가지고 있지 않을 수 있습니다. Front End Transport Service에서는 각 사서함 데이터베이스에 대한 배달 그룹 및 관련 라우팅 정보를 조회합니다. Front End Transport Service에서 사용되는 배달 그룹은 다음과 같습니다.

  - 라우팅할 수 있는 DAG

  - 사서함 배달 그룹

  - AD 사이트

받는 사람의 수와 유형에 따라 Front End Transport Service에서는 다음 작업 중 하나를 수행합니다.

  - 사서함 받는 사람이 한 명인 메시지의 경우 대상 배달 그룹에서 사서함 서버를 선택하고, Active Directory 사이트의 근접성을 기반으로 사서함 서버에 우선권을 부여합니다. 메시지를 받는 사람에게 라우팅하는 작업에는 메시지를 허브 사이트로 라우팅하는 작업이 포함됩니다.

  - 사서함 받는 사람이 여러 명인 메시지의 경우 처음 20명을 사용하여, Active Directory 사이트의 근접성을 기반으로 가장 가까운 배달 그룹에서 사서함 서버를 선택합니다. 프런트 엔드 전송에서는 메시지 분기가 발생하지 않으므로 메시지의 받는 사람 수에 관계없이 하나의 사서함 서버만 선택됩니다.

  - 메시지에 사서함 받는 사람이 없으면 로컬 Active Directory 사이트의 임의 사서함 서버를 선택합니다.

맨 위로 이동

## 사서함 서버에 있는 사서함 전송 서비스의 라우팅

이 서비스에는 다음의 서로 다른 두 서비스가 포함됩니다. 사서함 전송 제출 서비스 및 사서함 전송 배달 서비스. 들어오는 메시지의 경우 사서함 전송 배달 서비스에서는 Transport Service로부터 SMTP 메시지를 받고 RPC를 통해 로컬 사서함 데이터베이스에 연결하여 메시지를 배달합니다. 나가는 메시지의 경우 사서함 전송 제출 서비스에서는 RPC를 통해 로컬 사서함 데이터베이스에 연결하여 메시지를 검색하고 SMTP를 통해 메시지를 Transport Service에 제출합니다. Mailbox Transport Service는 상태 비저장이며 모든 메시지를 로컬로 큐에 넣지 않습니다.

Transport Service와 마찬가지로 Mailbox Transport Service에서는 Active Directory의 정보를 기반으로 라우팅 테이블을 로드하고 배달 그룹을 사용하여 메시지를 라우팅하는 방법을 결정합니다. 그러나 Mailbox Transport Service에 대해 고유한 라우팅 요소가 있습니다.

  - Transport Service 및 Mailbox Transport Service는 동일한 Exchange 2013 사서함 서버에 있으므로 Mailbox Transport Service는 항상 사서함 서버와 동일한 배달 그룹에 속합니다. 이 배달 그룹을 *로컬 배달 그룹*이라고 합니다.

  - 사서함 전송 제출 서비스에서는 로컬 사서함 서버나 고유한 로컬 배달 그룹의 다른 사서함 서버에 있는 Transport Service로 메시지를 자동으로 보내지 않습니다. 사서함 전송 제출 서비스에서는 Transport Service와 동일한 라우팅 토폴로지 정보에 액세스할 수 있으므로 배달 그룹 외부에 있는 사서함 서버의 Transport Service로 메시지를 보낼 수 있습니다. 로컬 배달 그룹의 사서함 서버는 비 사서함 받는 사람에 배달하기 위한 대체 옵션으로 사용됩니다.

  - Mailbox Transport Service만 Exchange 2013 사서함 서버의 Transport Service와 통신합니다.

  - Mailbox Transport Service만 로컬 Exchange 2013 사서함 서버의 사서함 데이터베이스와 통신합니다. Mailbox Transport Service는 다른 사서함 서버의 사서함 데이터베이스와 통신하지 않습니다.

사용자가 자신의 사서함에서 메시지를 보낼 경우 사서함 전송 제출 서비스에서는 메시지 받는 사람을 사서함 데이터베이스로 확인합니다. 사서함 전송 제출 서비스에서 사용되는 사서함 서버의 목록은 메시지 받는 사람의 사서함 데이터베이스를 기반으로 합니다. 예를 들어 받는 사람이 메일 그룹이거나 메일 사용자인 경우 사서함을 가지고 있지 않을 수 있습니다. 사서함 전송 제출 서비스에서는 각 사서함 데이터베이스에 대해 배달 그룹 및 관련 라우팅 정보를 조회합니다. 사서함 전송 제출 서비스에서 사용되는 배달 그룹은 다음과 같습니다.

  - 라우팅할 수 있는 DAG

  - 사서함 배달 그룹

  - AD 사이트

받는 사람의 수와 유형에 따라 사서함 전송 제출 서비스에서는 다음 작업 중 하나를 수행합니다.

  - 사서함 받는 사람이 한 명인 메시지의 경우 대상 배달 그룹에서 사서함 서버를 선택하고, Active Directory 사이트의 근접성을 기반으로 사서함 서버에 우선권을 부여합니다. 메시지를 받는 사람에게 라우팅하는 작업에는 메시지를 허브 사이트로 라우팅하는 작업이 포함됩니다.

  - 사서함 받는 사람이 여러 명인 메시지의 경우 처음 20명을 사용하여, Active Directory 사이트의 근접성을 기반으로 가장 가까운 배달 그룹에서 사서함 서버를 선택합니다.

  - 메시지에 사서함 받는 사람이 없으면 로컬 배달 그룹의 사서함 서버를 선택합니다.

사서함 전송 배달 서비스에서는 Transport Service에서 메시지를 받으면 로컬 사서함 데이터베이스로 배달하기 위해 해당 메시지를 수락하거나 거부합니다. 사서함 전송 배달 서비스에서는 받는 사람이 로컬 사서함 데이터베이스의 활성 복사본에 있는 경우 메시지를 배달할 수 있습니다. 그러나 받는 사람이 로컬 사서함 데이터베이스의 활성 복사본에 없으면 사서함 전송 배달 서비스에서 메시지를 배달할 수 없으며 Transport Service에 배달 못 함 응답을 제공해야 합니다. 예를 들어 사서함 데이터베이스의 활성 복사본이 최근에 다른 서버로 이동된 경우 Transport Service에서 사서함 데이터베이스의 비활성 복사본이 보관된 사서함 서버로 메시지를 잘못 전송할 수 있습니다. 사서함 전송 배달 서비스에서 Transport Service로 반환되는 배달 못 함 응답에는 다음이 포함됩니다.

  - 배달 다시 시도

  - NDR 생성

  - 메시지 다시 라우팅

맨 위로 이동

## Edge 전송 서버에 있는 전송 서비스의 라우팅

경계 네트워크에 Edge 전송 서버가 설치되어 있으면 Edge 전송 서버의 전송 서비스에서 모든 인터넷 연결 메일 흐름에 대한 SMTP 릴레이 및 스마트 호스트 서비스가 제공됩니다. 인터넷에서 송수신되는 메시지는 Edge 전송 서버에서 로컬로 대기됩니다. 큐는 외부 도메인 또는 송신 커넥터에 해당합니다. 자세한 내용은 [큐](queues-exchange-2013-help.md) 항목의 "NextHopSolutionKey" 섹션을 참조하세요.

일반적으로 경계 네트워크에 Edge 전송 서버를 설치할 때는 Active Directory 사이트에 Edge 전송 서버를 구독합니다. Active Directory 사이트에는 Edge 전송 서버에서/서버로 메시지를 릴레이하는 사서함 서버가 포함됩니다. Edge 구독 프로세스를 통해 해당 Edge 전송 서버에 대한 Active Directory 사이트 구성원 정보도 만들어집니다. 이 사이트 정보를 사용하면 Active Directory 사이트의 사서함 서버가 명시적인 송신 커넥터를 구성하지 않고도 인터넷 배달용으로 Edge 전송 서버에 메시지를 릴레이할 수 있습니다.

다중 사이트 구성에서는 인터넷 받는 사람이 외부 받는 사람에게 보내는 아웃바운드 메일이 먼저 구독된 Active Directory 사이트로 라우팅됩니다. 대상 Active Directory 사이트는 배달 그룹입니다. 라우팅 대상은 구독된 Active Directory 사이트에 있는 사서함 서버의 전송 서비스에 포함된 조직 내 송신 커넥터입니다. *조직 내 송신 커넥터*는 모든 사서함 서버의 전송 서비스에 있는 특수한 송신 커넥터로, 암시적으로 만들어지고 표시되지 않으며 관리할 필요가 없고, Exchange 서버 간의 메시지를 릴레이하는 데 사용됩니다.

외부 받는 사람에 대한 아웃바운드 메일은 사서함 서버에서 Edge 전송 서버로 라우팅됩니다. 클라이언트 액세스 서버는 구독된 Edge 전송 서버로 메일을 라우팅하는 데 사용되지 않습니다. 메일은 사서함 서버에 있는 전송 서비스의 조직 내 송신 커넥터에서 Edge 전송 서버에 있는 전송 서비스의 수신 커넥터로 전송됩니다. 구독된 Edge 전송 서버에서 기본 수신 커넥터는 구독된 Active Directory 사이트에 포함된 내부 사서함 서버로부터의 연결 및 인터넷으로부터의 익명 연결을 수신 대기하도록 구성됩니다. Edge 전송 서버의 전송 서비스가 메시지를 분류하고 나면 메시지는 Edge 구독 중에 만들어진 전용 송신 커넥터를 사용하여 인터넷으로 배달하기 위해 로컬로 대기됩니다.

외부 받는 사람으로부터의 인바운드 메일은 기본 수신 커넥터를 통해 Edge 전송 서버에 도착하며, 해당 서버에서 메시지가 분류되고 배달을 위해 대기됩니다. 이 메시지는 Exchange 조직으로 메일을 보내기 위해 Edge 구독에서 만드는 전용 송신 커넥터로 릴레이됩니다. 그 다음에 메시지가 이동하는 위치는 내부 Exchange 서버가 구성된 방식에 따라 달라집니다.

  - **같은 컴퓨터에 설치된 사서함 서버 및 클라이언트 액세스 서버**   이 구성에서는 클라이언트 액세스 서버가 인바운드 메일 흐름에 사용됩니다. 메일은 Edge 전송 서버에 있는 전송 서비스의 송신 커넥터에서 클라이언트 액세스 서버에 있는 프런트 엔드 전송 서비스의 기본 수신 커넥터로 이동한 다음 사서함 서버에 있는 전송 서비스의 기본 수신 커넥터로 이동합니다.

  - **다른 컴퓨터에 설치된 사서함 서버 및 클라이언트 액세스 서버**   이 구성에서는 인바운드 메일 흐름에 대해 클라이언트 액세스 서버가 무시됩니다. 메일은 Edge 전송 서버에 있는 전송 서비스의 송신 커넥터에서 사서함 서버에 있는 전송 서비스의 기본 수신 커넥터로 이동합니다.

경계 네트워크에 Exchange 2007 또는 Exchange 2010 Edge 전송 서버가 설치되어 있는 경우 인바운드 및 아웃바운드 메일 흐름은 항상 Edge 전송 서버와 사서함 서버 간에 직접 진행되며 클라이언트 액세스 서버는 사용되지 않습니다.

맨 위로 이동

